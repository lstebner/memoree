(function(){var t;t={init:function(){return this.toolbar=new t.Toolbar("#toolbar"),this.memoree=new t.Main("#memoree"),$(document.body).on("memoree:request",function(t){return function(e,s){return t.request(s)}}(this))},request:function(t){if(!(_.indexOf(["reset"],t)>-1))return console.log("requested action is not available");switch(t){case"reset":return this.memoree.reset()}}},t.Main=function(){function t(t,e){this.opts=null!=e?e:{},this.opts=_.extend({shuffle:!0,mode:"echo",theme:"alt"},this.opts),this.container=$(t),this.container.addClass(this.opts.theme),this.setup(),this.render()}return t.prototype.setup=function(){return this.uncovered_cards=0,this.matched_cards=0,this.stats={clicks:0,matched:0,remaining:0},this.card_zone=this.container.find(".card_zone"),this.load_deck(),this.setup_events()},t.prototype.setup_events=function(){return this.container.on("click",function(t){return function(e){var s,n,r,i;return r=!0,i=!0,n=$(e.target),s=$(e.currentTarget),n.is(".card")&&t.click_card(n,e),r&&e.preventDefault(),i?void 0:e.stopPropagation()}}(this))},t.prototype.load_deck=function(){return this.words=dictionary_words,this.stats.remaining=this.words.length,this.stats_updated()},t.prototype.stats_updated=function(){return this.container.trigger("memoree:stats:update",this.stats)},t.prototype.render=function(){var t,e,s,n,r,i,o,c,a,u,d,h;for(this.cards=[],a=this.words,n=s=0,i=a.length;i>s;n=++s)d=a[n],h=d[0],c="echo"===this.opts.mode?d[0]:d[1],t="<div class='card' data-id='"+n+"'><span>"+h+"</span></div>",this.cards.push(t),c="<div class='card' data-id='"+n+"m'><span>"+c+"</span></div>",this.cards.push(c);for(e=this.opts.shuffle?_.shuffle(this.cards):this.cards,u=[],r=0,o=e.length;o>r;r++)t=e[r],u.push(this.card_zone.append(t));return u},t.prototype.click_card=function(t,e){return!this.check_cards_to&&_.isEmpty(_.intersection(t[0].classList,["match","miss","uncover"]))?(this.uncovered_cards<2&&this.uncover(t),2===this.uncovered_cards?this.check_cards_to=setTimeout(function(t){return function(){return t.check_cards_to=null,t.check_uncovered_cards(),t.matched_cards===t.words.length?t.finished():void 0}}(this),500):void 0):void 0},t.prototype.uncover=function(t){return t.addClass("uncover"),this.stats.clicks++,this.stats_updated(),this.uncovered_cards++},t.prototype.check_uncovered_cards=function(){var t,e,s,n,r,i;return t=this.container.find(".card.uncover"),2!==t.length?console.log("not enough uncovered cards"):(n=function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],s=$(e).data("id"),i.push(s);return i}(),r=this.is_match(n[0],n[1]),i=r?(this.matched_cards++,this.stats.matched++,this.stats.remaining--,this.stats_updated(),"match"):(setTimeout(function(t){return function(){return t.container.find(".miss").removeClass("miss")}}(this),800),"miss"),t.addClass(i).removeClass("uncover"),this.uncovered_cards=0,r)},t.prototype.is_match=function(t,e){return e===t+"m"||t===e+"m"},t.prototype.finished=function(){return console.log("all cards matched!"),this.container.addClass("complete")},t.prototype.reset=function(){return this.uncovered_cards=0,this.matched_cards=0,this.card_zone.html(""),this.container.removeClass("complete"),this.render()},t}(),t.Toolbar=function(){function t(t,e){this.opts=null!=e?e:{},this.container=$(t),this.setup()}return t.prototype.setup=function(){return this.setup_events()},t.prototype.setup_events=function(){return this.container.on("click",function(t){return function(e){var s,n,r,i;return r=!0,i=!0,n=$(e.target),s=$(e.currentTarget),n.is(".reset_btn")&&confirm("Are you sure?")&&t.container.trigger("memoree:request","reset"),r&&e.preventDefault(),i?void 0:e.stopPropagation()}}(this)),$(document.body).on("memoree:stats:update",function(t){return function(e,s){return t.stats=s,t.render_stats()}}(this))},t.prototype.render_stats=function(){var t,e;return t=this.container.find(".stats").html(""),e="clicks: "+this.stats.clicks+"  matched: "+this.stats.matched+"  remaining: "+this.stats.remaining,t.text(e),console.log(this.stats)},t}(),$(function(){return document.Memoree=t,document.Memoree.init()})}).call(this);